- name: Bootstrap dev environment
  hosts: localhost
  tasks:
    - name: Install packages with pacman
      become: yes
      community.general.pacman:
        name:
          - alacritty
          - bat
          - bat-extras
          - calibre
          - chezmoi
          - clang
          - docker
          - docker-compose
          - efibootmgr
          - exiftool
          - eza
          - fd
          - ffmpeg
          - firefox
          - fontconfig
          - fzf
          - git
          - git-delta
          - glances
          - lazygit
          - lm_sensors
          - lua
          - luajit
          - lua-language-server
          - man-db
          - man-pages
          - mpv
          - ncdu
          - neovim
          - networkmanager
          - nodejs
          - npm
          - p7zip
          - pavucontrol
          - pipewire
          - python
          - python-pipx
          - qbittorrent
          - ripgrep
          - starship
          - syncthing
          - tmux
          - tree
          - ttf-jetbrains-mono-nerd
          - unrar
          - unzip
          - veracrypt
          - vim
          - wl-clipboard
          - yt-dlp
          - zathura
          - zathura-pdf-poppler
          - zsh
        state: present
      when: ansible_facts["os_family"] == "Archlinux"

    - name: Change shell to zsh
      become: yes
      ansible.builtin.user:
        name: "{{ ansible_user_id }}"
        shell: "/bin/zsh"

    - name: Install pipx packages
      loop:
        - "git+https://github.com/johnnymorganz/stylua"
        - ipython
        - ruff
        - trash-cli
        - "trash-cli[completion]"
        - "yt-dlp[default]"
      community.general.pipx:
        name: "{{ item }}"
        state: present
        executable: pipx

    - name: install npm global packages
      loop:
        - "@ansible/ansible-language-server"
        # - deno
        - emmet-ls
        # - "@fsouza/prettierd"
        - intelephense
        # - "@johnnymorganz/stylua-bin"
        - live-server
        # - prettier
        # - pyright
        - typescript
        - typescript-language-server
        - vim-language-server
        - vscode-langservers-extracted
        # - "vite" https://www.npmjs.com/package/vite
      community.general.npm:
        name: "{{ item }}"
        global: true
        state: present

# todo: add deno's install script to ansible, and perhaps bun too.
