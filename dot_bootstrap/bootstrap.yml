- name: Bootstrap dev environment
  hosts: localhost
  tasks:
    - name: Install packages with pacman
      become: yes
      community.general.pacman:
        name:
          - alacritty
          - bat
          - chezmoi
          - efibootmgr
          - fd
          - ffmpeg
          - firefox
          - fontconfig
          - fzf
          - git
          - lazygit
          - lm_sensors
          - lua
          - luajit
          - lua-language-server
          - man-db
          - man-pages
          - mpv
          - neovim
          - networkmanager
          - nodejs
          - npm
          - pavucontrol
          - pipewire
          - python
          - python-pipx
          - qbittorrent
          - ripgrep
          - starship
          - tmux
          - tree
          - ttf-jetbrains-mono-nerd
          - unrar
          - unzip
          - veracrypt
          - vim
          - wl-clipboard
          - yt-dlp
          - zsh
        state: present
      when: ansible_facts["os_family"] == "Archlinux"

    - name: Change shell to zsh
      become: yes
      ansible.builtin.user:
        name: "{{ ansible_user_id }}"
        shell: "/bin/zsh"

    - name: Install pipx packages
      loop:
        - ruff
        - ipython
        - trash-cli
        - "trash-cli[completion]"
      community.general.pipx:
        name: "{{ item }}"
        state: present
        executable: pipx

    - name: install npm global packages
      loop:
        - "@ansible/ansible-language-server"
        - "@johnnymorganz/stylua-bin"
        - "@fsouza/prettierd"
        - prettier
        - deno
        - pyright
        - intelephense
        - live-server
        # - "vite" https://www.npmjs.com/package/vite
      community.general.npm:
        name: "{{ item }}"
        global: true
        state: present
